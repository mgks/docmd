<%# Source file from the docmd project — https://github.com/docmd-io/docmd %>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <%- metaTagsHtml || '' %>

    <title><%= pageTitle %><% if(siteTitle) { %> : <%= siteTitle %><% } %></title>
    <% if (description && !(metaTagsHtml && metaTagsHtml.includes('name="description"'))) { %>
    <meta name="description" content="<%= description %>">
    <% } %>

    <%- faviconLinkHtml || '' %>

    <!-- Theme Mode -->
    <script>window.DOCMD_DEFAULT_MODE = "<%= defaultMode %>";</script>

    <!-- Syntax Highlighting -->
    <% if (config.theme?.codeHighlight !== false) { %>
    <link rel="stylesheet" id="highlight-theme" href="<%= relativePathToRoot %>assets/css/docmd-highlight-<%= defaultMode === 'dark' ? 'dark' : 'light' %>.css" data-base-href="<%= relativePathToRoot %>assets/css/">
    <% } %>

    <!-- Styles -->
    <link rel="stylesheet" href="<%= relativePathToRoot %>assets/css/docmd-main.css">
    <%- themeCssLinkHtml || '' %>
    <% (customCssFiles || []).forEach(cssFile => { %>
    <link rel="stylesheet" href="<%= relativePathToRoot %><%- cssFile.startsWith('/') ? cssFile.substring(1) : cssFile %>">
    <% }); %>
    <%- pluginStylesHtml || '' %>

    <!-- Theme Init -->
    <%- themeInitScript %>

    <%- pluginHeadScriptsHtml || '' %>
</head>
<body class="<%= sidebarConfig.collapsible ? 'sidebar-collapsible' : 'sidebar-not-collapsible' %>" 
      data-default-collapsed="<%= sidebarConfig.defaultCollapsed %>" 
      data-copy-code-enabled="<%= config.copyCode === true %>">

    <aside class="sidebar">
        <div class="sidebar-header">
            <% if (logo && logo.light && logo.dark) { %>
            <a href="<%= logo.href || relativePathToRoot %>" class="logo-link">
                <img src="<%= relativePathToRoot %><%- logo.light.startsWith('/') ? logo.light.substring(1) : logo.light %>" alt="<%= logo.alt || siteTitle %>" class="logo-light" <% if (logo.height) { %>style="height: <%= logo.height %>;"<% } %>>
                <img src="<%= relativePathToRoot %><%- logo.dark.startsWith('/') ? logo.dark.substring(1) : logo.dark %>" alt="<%= logo.alt || siteTitle %>" class="logo-dark" <% if (logo.height) { %>style="height: <%= logo.height %>;"<% } %>>
            </a>
            <% } else { %>
            <h1><a href="<%= relativePathToRoot %>index.html"><%= siteTitle %></a></h1>
            <% } %>
            <span class="mobile-view sidebar-menu-button float-right">
                <%- renderIcon("ellipsis-vertical") %>
            </span>
        </div>

        <%- navigationHtml %>

        <% if (theme && theme.enableModeToggle && theme.positionMode !== 'top') { %>
        <button id="theme-toggle-button" aria-label="Toggle theme" class="theme-toggle-button">
            <%- renderIcon('sun', { class: 'icon-sun' }) %> <%- renderIcon('moon', { class: 'icon-moon' }) %>
        </button>
        <% } %>
    </aside>

    <div class="main-content-wrapper">
        <div class="page-header">
            <div class="header-left">
                <% if (sidebarConfig.collapsible) { %>
                <button id="sidebar-toggle-button" class="sidebar-toggle-button" aria-label="Toggle Sidebar">
                    <%- renderIcon('panel-left-close') %>
                </button>
                <% } %>
                <h1><%= pageTitle %></h1>
            </div>
            <% if (theme && theme.enableModeToggle && theme.positionMode === 'top') { %>
            <div class="header-right">
                <% if (config.search !== false) { %>
                <button class="docmd-search-trigger" aria-label="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search-icon lucide-search"><path d="m21 21-4.34-4.34"></path><circle cx="11" cy="11" r="8"></circle></svg>
                    <span class="search-label">Search</span>
                    <span class="search-keys"><kbd class="docmd-kbd">⌘</kbd><kbd class="docmd-kbd">k</kbd></span>
                </button>
                <% } %>
                <button id="theme-toggle-button" aria-label="Toggle theme" class="theme-toggle-button theme-toggle-header">
                    <%- renderIcon('sun', { class: 'icon-sun' }) %> <%- renderIcon('moon', { class: 'icon-moon' }) %>
                </button>
            </div>
            <% } %>
        </div>

        <main class="content-area">
            <div class="content-layout">
                <div class="main-content">
                    <%- content %>

                    <% if (config.pageNavigation && (prevPage || nextPage)) { %>
                    <div class="page-navigation">
                        <% if (prevPage) { %>
                        <a href="<%= prevPage.url %>" class="prev-page">
                            <%- renderIcon('arrow-left', { class: 'page-nav-icon' }) %>
                            <span><small>Previous</small><strong><%= prevPage.title %></strong></span>
                        </a>
                        <% } else { %><div class="prev-page-placeholder"></div><% } %>
                        <% if (nextPage) { %>
                        <a href="<%= nextPage.url %>" class="next-page">
                            <span><small>Next</small><strong><%= nextPage.title %></strong></span>
                            <%- renderIcon('arrow-right', { class: 'page-nav-icon' }) %>
                        </a>
                        <% } else { %><div class="next-page-placeholder"></div><% } %>
                    </div>
                    <% } %>
                </div>

                <div class="toc-sidebar">
                    <%- include('toc', { content, headings, navigationHtml, isActivePage }) %>
                </div>
            </div>

            <div class="page-footer-actions">
                <% if (locals.editUrl) { %>
                <a href="<%= editUrl %>" target="_blank" rel="noopener noreferrer" class="edit-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pencil"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg> <%= editLinkText %>
                </a>
                <% } %>
            </div>
        </main>

        <footer class="page-footer">
            <div class="footer-content">
                <div class="user-footer"><%- footerHtml || '' %></div>
                <div class="branding-footer">
                    Build with <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path><path d="M12 5 9.04 7.96a2.17 2.17 0 0 0 0 3.08c.82.82 2.13.85 3 .07l2.07-1.9a2.82 2.82 0 0 1 3.79 0l2.96 2.66"></path><path d="m18 15-2-2"></path><path d="m15 18-2-2"></path></svg> <a href="https://docmd.io" target="_blank" rel="noopener">docmd.</a>
                </div>
            </div>
        </footer>
    </div>

    <% if (config.search !== false) { %>
    <!-- Search Modal -->
    <div id="docmd-search-modal" class="docmd-search-modal" style="display: none;">
        <div class="docmd-search-box">
            <div class="docmd-search-header">
                <svg xmlns="http://www.w3.org/2000/svg" width="1.25em" height="1.25em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search-icon lucide-search"><path d="m21 21-4.34-4.34"></path><circle cx="11" cy="11" r="8"></circle></svg>
                <input type="text" id="docmd-search-input" placeholder="Search documentation..." autocomplete="off" spellcheck="false">
                <button onclick="window.closeDocmdSearch()" class="docmd-search-close" aria-label="Close search">
                    <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x-icon lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div id="docmd-search-results" class="docmd-search-results"></div>
            <div class="docmd-search-footer">
                <span><kbd class="docmd-kbd">↑</kbd> <kbd class="docmd-kbd">↓</kbd> to navigate</span>
                <span><kbd class="docmd-kbd">ESC</kbd> to close</span>
            </div>
        </div>
    </div>
    <% } %>

    <!-- Scripts -->
    <script>window.DOCMD_ROOT = "<%= relativePathToRoot %>";</script>
    <script src="<%= relativePathToRoot %>assets/js/docmd-main.js"></script>

    <% if (config.search !== false) { %>
    <script src="https://cdn.jsdelivr.net/npm/minisearch@7.2.0/dist/umd/index.min.js"></script>
    <script src="<%= relativePathToRoot %>assets/js/docmd-search.js"></script>
    <% } %>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@11.12.2/dist/mermaid.min.js"></script>
    <script src="<%= relativePathToRoot %>assets/js/docmd-mermaid.js"></script>

    <% (customJsFiles || []).forEach(jsFile => { %>
    <script src="<%= relativePathToRoot %><%- jsFile.startsWith('/') ? jsFile.substring(1) : jsFile %>"></script>
    <% }); %>

    <%- pluginBodyScriptsHtml || '' %>

    <% if (sponsor && sponsor.enabled) { %>
    <div class="sponsor-ribbon">
        <a href="<%= sponsor.link %>" target="_blank" rel="noopener noreferrer" class="sponsor-link">
            <%- renderIcon('heart', { class: 'sponsor-icon' }) %>
            <span class="sponsor-text"><%= sponsor.title %></span>
        </a>
    </div>
    <% } %>
</body>
</html>